# Generated by Django 4.2.22 on 2025-10-15 21:08

from django.db import migrations, models
import django.db.models.deletion
import modelcluster.fields
import wagtail.search.index


class Migration(migrations.Migration):

    dependencies = [
        ("wagtailcore", "0089_log_entry_data_json_null_to_object"),
        ("library", "0034_alter_codebasegitremote_should_auto_push"),
    ]

    operations = [
        migrations.CreateModel(
            name="GitHubIntegrationConfiguration",
            fields=[
                (
                    "id",
                    models.AutoField(
                        auto_created=True,
                        primary_key=True,
                        serialize=False,
                        verbose_name="ID",
                    ),
                ),
                (
                    "enable_new_connections",
                    models.BooleanField(
                        default=True,
                        help_text="Disabling will prevent new repositories from being connected, existing connections will remain active, visible, and editable.",
                    ),
                ),
                (
                    "is_beta",
                    models.BooleanField(
                        default=True,
                        help_text="Mark the GitHub integration feature as a beta feature",
                    ),
                ),
            ],
            options={
                "abstract": False,
            },
        ),
        migrations.CreateModel(
            name="GitHubIntegrationTutorialVideo",
            fields=[
                (
                    "id",
                    models.AutoField(
                        auto_created=True,
                        primary_key=True,
                        serialize=False,
                        verbose_name="ID",
                    ),
                ),
                (
                    "title",
                    models.CharField(
                        blank=True,
                        help_text="optional short title for the tutorial",
                        max_length=200,
                    ),
                ),
                (
                    "youtube_id",
                    models.CharField(
                        help_text="YouTube video id (e.g., dQw4w9WgXcQ)", max_length=32
                    ),
                ),
                (
                    "description",
                    models.TextField(
                        blank=True, help_text="optional short description"
                    ),
                ),
                (
                    "order",
                    models.PositiveIntegerField(
                        default=0,
                        help_text="order in which this tutorial should appear",
                    ),
                ),
            ],
            options={
                "ordering": ["order", "id"],
            },
            bases=(wagtail.search.index.Indexed, models.Model),
        ),
        migrations.RemoveField(
            model_name="githubsyncconfiguration",
            name="site",
        ),
        migrations.RemoveConstraint(
            model_name="codebasegitremote",
            name="single_active_remote",
        ),
        migrations.RenameField(
            model_name="codebasegitremote",
            old_name="active",
            new_name="is_active",
        ),
        migrations.RemoveField(
            model_name="importedreleasesyncstate",
            name="date_created",
        ),
        migrations.RemoveField(
            model_name="importedreleasesyncstate",
            name="last_modified",
        ),
        migrations.AddConstraint(
            model_name="codebasegitremote",
            constraint=models.UniqueConstraint(
                condition=models.Q(("is_active", True)),
                fields=("codebase",),
                name="single_active_remote",
            ),
        ),
        migrations.RenameModel(
            old_name="GitHubSyncFaqEntry",
            new_name="GitHubIntegrationFaqEntry",
        ),
        migrations.DeleteModel(
            name="GitHubSyncConfiguration",
        ),
        migrations.AddField(
            model_name="githubintegrationtutorialvideo",
            name="configuration",
            field=modelcluster.fields.ParentalKey(
                on_delete=django.db.models.deletion.CASCADE,
                related_name="tutorial_videos",
                to="library.githubintegrationconfiguration",
            ),
        ),
        migrations.AddField(
            model_name="githubintegrationconfiguration",
            name="site",
            field=models.OneToOneField(
                editable=False,
                on_delete=django.db.models.deletion.CASCADE,
                to="wagtailcore.site",
            ),
        ),
        migrations.AlterField(
            model_name="githubintegrationfaqentry",
            name="configuration",
            field=modelcluster.fields.ParentalKey(
                on_delete=django.db.models.deletion.CASCADE,
                related_name="faq_entries",
                to="library.githubintegrationconfiguration",
            ),
        ),
    ]
